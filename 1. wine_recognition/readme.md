# ì™€ì¸ìƒµ ì¬ê³ ê´€ë¦¬ í”„ë¡œì íŠ¸
 

    â­ ì™€ì¸ìƒµ ì‹¤ì¬ê³ ì¡°ì‚¬ ì—…ë¬´ë¥¼ AI ë° ML ê¸°ìˆ ì„ í†µí•´ ê°œì„ í•˜ê³ ì í•˜ì˜€ìŠµë‹ˆë‹¤.


ğŸ“– **ëª©ì°¨**

[1. í”„ë¡œì íŠ¸ ê°œìš”](#1-í”„ë¡œì íŠ¸-ê°œìš”)

[2. ë°ì´í„° ìˆ˜ì§‘ ë° ì „ì²˜ë¦¬](#2-ë°ì´í„°-ìˆ˜ì§‘-ë°-ì „ì²˜ë¦¬)

[3. ëª¨ë¸ë§](#3-ëª¨ë¸ë§)

[4. ìˆ˜í–‰ ê²°ê³¼](#4-ìˆ˜í–‰-ê²°ê³¼)

***

## 1 í”„ë¡œì íŠ¸ ê°œìš”

### 1.1 ë°°ê²½
ë°±í™”ì  ë‚´ ê°¤ëŸ¬ë¦¬ì•„ ì†Œì†ì˜ ì§€ì ë“¤ì€ ë¶„ê¸°ë§ˆë‹¤ ì‹¤ì¬ê³ ì¡°ì‚¬ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤. ë°”ì´ì–´ë“¤ì€ ì¬ê³ ì¡°ì‚¬ì‹œ ëª¨ë“  ì™€ì¸ì˜ ë°”ì½”ë“œë¥¼ PDAë¡œ ìŠ¤ìº”í•˜ì—¬ ì „ì‚°í™” ì‹œí‚µë‹ˆë‹¤. ì™€ì¸ìƒµì˜ ê²½ìš° ë§¤ì¥ì— ì „ì‹œëœ ì™€ì¸ì€ ì•½ 1300ì¢…ì´ê¸° ë•Œë¬¸ì— 4ëª…ì˜ ì§ì›ì´ ì•½ 7~8 ì‹œê°„ì˜ ì‘ì—…ì„ í†µí•´  ì¬ê³ ì¡°ì‚¬ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤. ì´ëŠ” ë‹¨ìˆœì—…ë¬´ì´ì§€ë§Œ ì™€ì¸ì€ ì˜¨ë„ì— ë¯¼ê°í•˜ê³  ë‚´êµ¬ì„±ì´ ì¢‹ì§€ ì•Šê¸° ë•Œë¬¸ì— ì—…ë¬´ì˜ ê°•ë„ê°€ ì˜¬ë¼ê°€ê²Œ ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ì €ëŠ” ì™€ì¸ ë¼ë²¨ì„ ì¸ì‹í•˜ê³  ë¶„ë¥˜í•˜ëŠ” ëª¨ë¸ì„ í†µí•´ ì´ë¥¼ ê°œì„ í•˜ê³ ì í•˜ì˜€ìŠµë‹ˆë‹¤.

### 1.2 ëª©í‘œ
    ì™€ì¸ ë¼ë²¨ ì¸ì‹ ë° ë¶„ë¥˜ ëª¨ë¸ì„ í†µí•œ ì¬ê³ ê´€ë¦¬ ê°„í¸í™”

***

## 2 ë°ì´í„° ìˆ˜ì§‘ ë° ì „ì²˜ë¦¬

### 2.1 ë°ì´í„° ìˆ˜ì§‘
    ë¹„ë…¸ 494ì— ì „ì‹œëœ ì¼ë¶€(26ì¢…)ì˜ ì™€ì¸ì— ëŒ€í•´ ê° ì™€ì¸ë‹¹ ì•½ 30ì¥ì˜ ì‚¬ì§„ì„ ì°ì—ˆìŠµë‹ˆë‹¤.
-> ì´ë¯¸ì§€ ì‚¬ì§„

### 2.2 ë°ì´í„° ì „ì²˜ë¦¬
    ìˆ˜ì§‘í•œ ì´ë¯¸ì§€ë¥¼ ëª¨ë¸ í•™ìŠµì„ ìœ„í•œ í˜•íƒœë¡œ ë°”ê¾¸ëŠ” ì‘ì—…ì„ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.

**2.2.1 Labeling**   
ì™€ì¸ ë¼ë²¨ ì¸ì‹ì„ ìœ„í•œ yolo ëª¨ë¸ì„ í•™ìŠµí•˜ê¸°ìœ„í•˜ì—¬ ê° ì‚¬ì§„ì˜ ë¼ë²¨ì— `label`ë¡œ ë§¤í•‘ì„ ì‹œì¼œì£¼ì—ˆìŠµë‹ˆë‹¤.   
-> ë¼ë²¨ë§ í•˜ëŠ” ì´ë¯¸ì§€ ì‚¬ì§„

**2.2.2 Word Dictionary**   
KAKAO OCR APIë¥¼ í†µí•´ ì™€ì¸ì— ì í˜€ìˆëŠ” í…ìŠ¤íŠ¸ë¥¼ ì¶”ì¶œí•˜ì˜€ê³ , ì´ë¥¼ ìƒí’ˆì½”ë“œì™€ ë§¤í•‘ì‹œì¼œ ë‹¨ì–´ ì‚¬ì „ì„ ì¤€ë¹„í•˜ì˜€ìŠµë‹ˆë‹¤. ì´í›„ Symspellì„ í†µí•´ ë‹¨ì–´ë¥¼ DBì— ìˆëŠ” ê¸°ì¡´ ìƒí’ˆì˜ ë‹¨ì–´ì™€ ìœ ì‚¬í•˜ê²Œ êµì •í•˜ì˜€ìŠµë‹ˆë‹¤.

ğŸ“Œ *Why use Symspell?*   

***

## 3 ëª¨ë¸ë§
    Obejcet Detectionê³¼ logistic ë° image ë¶„ë¥˜ê¸°ë¥¼ ì—°ê²°í•˜ì—¬ í•˜ë‚˜ì˜ ëª¨ë¸ë¡œ êµ¬ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.
    
Step1. Object Detection(Yolo) -> ì™€ì¸ ë¼ë²¨ ì¶”ì¶œ   
Step2. ì¶”ì¶œí•œ ì´ë¯¸ì§€ -> OCR -> ì¶”ì¶œ ë‹¨ì–´ êµì •(Symspell) -> ìƒí’ˆì½”ë“œ ì˜ˆì¸¡(Logistic)   
Step3. ì¶”ì¶œí•œ ì´ë¯¸ì§€ -> ì´ë¯¸ì§€ ë¶„ë¥˜ ë° ìƒí’ˆì½”ë“œ ì˜ˆì¸¡(ResNet)   
    
### 3.1 Yolo

    Yolo V5 ëª¨ë¸ì„ í•™ìŠµì‹œí‚¨ ë’¤ ì´ë¯¸ì§€ê°€ ë“¤ì–´ì˜¤ë©´ ì™€ì¸ì˜ ë¼ë²¨ì„ Crop í•˜ë„ë¡ ì„¤ê³„í•˜ì˜€ìŠµë‹ˆë‹¤.
 
ğŸ“Œ *vs Other Obeject detecting model (R-CNN, Fast R-CNN, Faster R-CNN)*   

> Yolo modelì€ 1 stepì˜ object detect ëª¨ë¸ì´ë¯€ë¡œ ë‹¤ë¥¸ 2 step ëª¨ë¸ì— ë¹„í•´ ì •í™•ë„ëŠ” ë¶€ì¡±í•  ìˆ˜ ìˆìœ¼ë‚˜ ì†ë„ì— ì´ì ì´ ìˆìŠµë‹ˆë‹¤.
> ì œê³µí•  ì„œë¹„ìŠ¤ëŠ” real timeìœ¼ë¡œ í™œìš©í•  ìˆ˜ ìˆì–´ì•¼ í•¨ìœ¼ë¡œ Yoloë¥¼ ì„ íƒí•˜ì˜€ìŠµë‹ˆë‹¤.   
> + ì‚¬ìš©í•˜ê¸°ë„ ê°€ì¥ ì‰½ê¸° ë•Œë¬¸ì´ê¸°ë„ í•©ë‹ˆë‹¤.

ğŸ“Œ *Why detect only 'Label'?*   

> b-boxë¥¼ í†µí•´ ê°ì²´ë¥¼ ì°¾ëŠ” Object detect ëª¨ë¸ íŠ¹ì„±ìƒ ì‘ì€ í”½ì…€ì˜ ë””í…Œì¼(ë…„ë„, ì›ì‚°ì§€ ë“±)ë¡œ êµ¬ë¶„ë˜ëŠ” ì™€ì¸ì˜ íŠ¹ì§•ì„ ì¡ì•„ë‚¼ ì§€ ì˜ë¬¸ì´ì—ˆê¸°ì— í˜„ ë‹¨ê³„ì—ì„œ ë¼ë²¨ë§Œ ì¶”ì¶œí•œ ë’¤ ë‹¤ìŒ ë‹¨ê³„ì—ì„œ ë¶„ë¥˜ë¥¼ ì§„í–‰í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•˜ì˜€ìŠµë‹ˆë‹¤.   
> + ì‹¤ì œ Labelì´ ì•„ë‹Œ ìƒí’ˆì½”ë“œ ë‹¨ìœ„ë¡œ í•™ìŠµì„ ì‹œì¼°ì„ì‹œ Accuracyê°€ ë–¨ì–´ì§ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.

### 3.2 Logistic

    OCRë¡œ ìˆ˜ì§‘í•œ ë‹¨ì–´ë¥¼ Symspellë¡œ ì „ì²˜ë¦¬í•œ ë°ì´í„°ë¥¼ í•™ìŠµë°ì´í„°ë¡œ ë¶„ë¥˜ ëª¨ë¸ì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.   
    ëª©ì í•¨ìˆ˜ëŠ” multi:softProbë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡ì˜ í™•ë¥ ê°’ì„ ì–»ê³ , ì´ë¥¼ ë‹¤ìŒ ëª¨ë¸ë¡œ ë„˜ì–´ê°ˆì§€ ë§ì§€ì— ëŒ€í•œ íŒë‹¨ ê¸°ì¤€ìœ¼ë¡œ ì •í•˜ì˜€ìŠµë‹ˆë‹¤.
    
**3.2.1 TF-IDF vectorize**

ğŸ“Œ *vs Count Vector*   
> ì™€ì¸ ë¼ë²¨ì— ì˜ë¯¸ê°€ ì—†ëŠ” ë‹¨ì–´ë“¤ì´ í¬í•¨ëœ ê²½ìš°ê°€ ìˆì—ˆê¸° ë•Œë¬¸ì— Counter Vector ë³´ë‹¤ëŠ” ë‹¤ë¥¸ ë¼ë²¨ì—ì„œë„ ë‚˜íƒ€ë‚˜ ë¹ˆë„ìˆ˜ê°€ ë§ì€ ë‹¨ì–´ì— ëŒ€í•œ ë³´ì •ì„ í•´ì£¼ëŠ” TF-IDFë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

ğŸ“Œ *vs Prediction Based Embedding (Word2Vec)*
> ì™€ì¸ ë¼ë²¨ì€ ë¬¸ë§¥ì  ì˜ë¯¸ë³´ë‹¤ëŠ” ë‹¨ì–´ ìì²´ì˜ ì¤‘ìš”ë„ê°€ í¬ê¸° ë•Œë¬¸ì— íšŸìˆ˜ ê¸°ë°˜ ì„ë² ë”©ì´ ì í•©í•˜ë‹¤ê³  íŒë‹¨í•˜ì˜€ìŠµë‹ˆë‹¤.

**3.2.2 Logistic Regression**

ğŸ“Œ  *vs Xgboost Classifier*   
> XgbclassifierëŠ” ì¼ë°˜ì ìœ¼ë¡œ Logisticë³´ë‹¤ ë¶„ë¥˜ì˜ ì„±ëŠ¥ì´ ì¢‹ì€ ê²ƒìœ¼ë¡œ ì•Œë ¤ì ¸ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ëª¨ë“  ê²½ìš°ê°€ ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” ê²ƒì„ ì´ë²ˆ í”„ë¡œì íŠ¸ë¥¼ í†µí•´ í™•ì¸í•˜ì˜€ìŠµë‹ˆë‹¤.   
> ë¬¼ë¡  Hyper Parameterì— ëŒ€í•œ ìµœì ê°’ ì—°êµ¬ë¥¼ í•˜ì§€ ëª»í•œ ì ì´ ê°€ì¥ í° ë¬¸ì œì´ê¸´ í•˜ë‚˜ Logisticë§Œìœ¼ë¡œë„ ë§Œì¡±í•  F1-Scoreê°€ ë‚˜ì™”ê¸° ë•Œë¬¸ì— Xgbclassifierë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

### 3.3 ResNet

    ì•ì„  ë¶„ë¥˜ ëª¨ë¸ì—ì„œ ì •í™•ë„ê°€ ë‚®ê²Œ ë‚˜ì˜¨ ë¼ë²¨ì€ ì™€ì¸ì˜ ë””í…Œì¼(Text Infomation)ì´ ì—†ëŠ” ì´ë¯¸ì§€ ë¼ë²¨ì…ë‹ˆë‹¤.   
    ë”°ë¼ì„œ ì´ë¯¸ì§€ ë¶„ë¥˜ê¸°ë¡œ ë‹¤ì‹œ ìƒí’ˆì½”ë“œë¥¼ ì˜ˆì¸¡í•˜ì˜€ìŠµë‹ˆë‹¤.

ğŸ“Œ *vs Other Image Classifier*   
> ResNetì€ Image ë¶„ë¥˜ê¸°ì˜ ì„±ëŠ¥ì„ ë†’ì—¬ì¤€ ê¸°ë²•ì´ê¸´ í•˜ë‚˜ ìµœê·¼ì—ëŠ” ì´ë³´ë‹¤ ì„±ëŠ¥ì´ ì¢‹ì€ ì•Œê³ ë¦¬ì¦˜ë“¤ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ê·¸ëŸ¼ì—ë„ ResNetì„ ì‚¬ìš©í•œ ì´ìœ ëŠ” ê³µë¶€í•œê±¸ ì¨ë¨¹ì–´ë³´ìë¼ëŠ” ë§ˆìŒì´ ì»¸ìŠµë‹ˆë‹¤.   
> ê¸°ìˆ ì ì¸ ì—°êµ¬ëŠ” í•˜ì§€ ëª»í•˜ì˜€ì§€ë§Œ SeResNetXt101 ëª¨ë¸ê³¼ Pre-trainëœ Weightë¥¼ ì‚¬ìš©í•˜ì˜€ì„ë•Œ ë” ì¢‹ì€ ì„±ëŠ¥ì„ ë³´ì„ì„ í™•ì¸í•˜ì˜€ìŠµë‹ˆë‹¤.   

***

## 4 ìˆ˜í–‰ ê²°ê³¼

### 4.1 Yolo

**í•™ìŠµì¡°ê±´**   
total image : 528   
cross validation : 5 K fold   
image size : 1024 * 1024   
epoch : 150   
batch : 32   


### 4.2 Logistic Regression

**í•™ìŠµì¡°ê±´**

### 4.3 ResNet

**í•™ìŠµì¡°ê±´**
